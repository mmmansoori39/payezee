"use strict";(self.webpackChunkweb=self.webpackChunkweb||[]).push([[28],{3028:function(e,t,n){n.r(t),n.d(t,{default:function(){return T}});var o=n(1413),a=n(9439),r=n(6636),s=n(4722),c=n(7727),i=n(7939),u=n(1396),d=n(2814),l=n(5515),m=n(658),p=n.n(m),h=n(6031),f=n(7313),v=n(5554),x=n(4491),C=n(1103),g=n(2355),D=n(2106),j=n(5503),A=n(7522),w=n(9566),b=n(1805),y=n(7547),S=n(8816),E=n(1433),P=n(9976),k=n(4451),Z=n(6417);var I=function(e){var t=e.isOpen,n=e.onClose,o=e.onConfirm,a=e.updateDetails,r=(0,f.useRef)();return(0,Z.jsx)(Z.Fragment,{children:(0,Z.jsx)(y.a,{isOpen:t,leastDestructiveRef:r,onClose:n,children:(0,Z.jsx)(S.Z,{children:(0,Z.jsxs)(y._,{children:[(0,Z.jsx)(E.x,{fontSize:"lg",fontWeight:"bold",children:"Update Transaction Status"}),(0,Z.jsxs)(P.f,{children:[(0,Z.jsx)("p",{children:"Are you sure? "}),(0,Z.jsxs)("p",{children:["You want to change the status to ",String(a.status).toUpperCase()]})]}),(0,Z.jsxs)(k.m,{children:[(0,Z.jsx)(c.z,{variant:"outline",ref:r,onClick:n,children:"Cancel"}),(0,Z.jsx)(c.z,{colorScheme:"teal",onClick:o,ml:3,children:"Update"})]})]})})})})},H=[null,new Date],N="all",T=function(e){var t=e.transactionType,n=void 0===t?"deposit":t,m=(0,f.useState)(H),y=(0,a.Z)(m,2),S=y[0],E=y[1],P=(0,v.I0)(),k=(0,v.v9)((function(e){return e.common})),T=k.deposits,M=k.loading,O=k.cashouts,R=k.merchants,K=(0,f.useState)(null),z=(0,a.Z)(K,2),B=z[0],U=z[1],J=(0,f.useState)({}),Y=(0,a.Z)(J,2),q=Y[0],W=Y[1],F=(0,r.q)(),G=F.isOpen,L=F.onOpen,V=F.onClose,_=(0,f.useState)(N),Q=(0,a.Z)(_,2),X=Q[0],$=Q[1],ee=(0,r.q)(),te=ee.isOpen,ne=ee.onOpen,oe=ee.onClose;(0,f.useEffect)((function(){(0,A.jP)().then((function(e){var t=e.map((function(e){return(0,o.Z)((0,o.Z)({},e),{},{status:e.isActive?"ACTIVE":"INACTIVE"})}));P((0,j.ZE)(t))}))}),[P]);var ae=(0,f.useState)(!1),re=(0,a.Z)(ae,2),se=re[0],ce=re[1];(0,f.useEffect)((function(){2===S.length&&("deposit"===n&&(P((0,j.K4)(!0)),(0,w.AS)({selectedDates:S,merchantId:X===N?null:X}).then((function(e){P((0,j.Jh)(e)),P((0,j.K4)(!1))}))),"cashout"===n&&(P((0,j.K4)(!0)),(0,w._9)({selectedDates:S,merchantId:X===N?null:X}).then((function(e){P((0,j.wK)(e)),P((0,j.K4)(!1))}))))}),[P,n,S,X]);var ie=(0,f.useCallback)((function(e){return function(){U(e),L()}}),[L]),ue=(0,f.useMemo)((function(){return[{Header:"Sr. No.",accessor:"sequence"},{Header:"Created on",accessor:"createdAt",Cell:function(e){var t=e.row.original.createdAt;return(0,Z.jsxs)("div",{style:{textAlign:"end"},children:[p()(t).format("hh:mm A"),(0,Z.jsx)("br",{}),p()(t).format("D MMMM  YYYY")]})}},{Header:"Invoice ID",accessor:"invoiceId"},{Header:"Merchant Name",accessor:"merchant.name"},{Header:"Name",accessor:"payer.firstName",Cell:function(e){var t=e.row.original.payer;return"".concat(t.firstName," ").concat(t.lastName)}},{Header:"Amount",accessor:"amount",Cell:function(e){var t=e.row.original,n=t.currency,o=t.amount;return"".concat(n," ").concat(o)}},{Header:"Address",accessor:"payer.address.city",Cell:function(e){var t,n,o,a,r=e.row.original.payer;return(0,Z.jsx)(s.x,{maxWidth:"200px",w:"max-content",children:"".concat(null===r||void 0===r||null===(t=r.address)||void 0===t?void 0:t.street,", ").concat(null===r||void 0===r||null===(n=r.address)||void 0===n?void 0:n.city,", \n ").concat(null===r||void 0===r||null===(o=r.address)||void 0===o?void 0:o.zipCode,", ").concat(null===r||void 0===r||null===(a=r.address)||void 0===a?void 0:a.state)})}},{Header:"STATUS",accessor:"status",Cell:function(e){var t=e.row.original.status,n=t===b.HA.PENDING?"#D69E2E":t===b.HA.REJECTED?"#E53E3E":t===b.HA.COMPLETED?"#38A169":"blue.500";return(0,Z.jsx)(s.x,{as:"span",bg:n,color:"white",p:"1",borderRadius:"md",children:String(t).toUpperCase()})}},{Header:"",accessor:"id",Cell:function(e){var t=e.cell;return(0,Z.jsx)(c.z,{onClick:ie(t.row.original),variant:"link",children:"View"})}}]}),[ie]),de=function(e,t){var n=(0,h.cloneDeep)(le),a=n.findIndex((function(e){return e.id===t.id}));n[a]=(0,o.Z)({},t),P(e(n))},le=(0,f.useMemo)((function(){return"deposit"===n?T:O}),[O,T,n]),me=(0,f.useMemo)((function(){var e=0;return le.forEach((function(t){t.status===b.HA.COMPLETED&&(e+=t.amount)})),e}),[le]);return(0,Z.jsxs)(i.xu,{p:{base:"4",md:"6"},children:[(0,Z.jsxs)(u.k,{alignItems:"center",w:"100%",justifyContent:"flex-start",mb:"4",children:[(0,Z.jsxs)(d.P,{w:"max-content",mr:"4",onChange:function(e){$(e.currentTarget.value)},value:X,children:[(0,Z.jsx)("option",{value:N,children:"all merchants"}),(null===R||void 0===R?void 0:R.length)&&R.map((function(e){return(0,Z.jsx)("option",{value:e.id,children:e.name},e.id)}))]}),(0,Z.jsx)(i.xu,{children:(0,Z.jsx)(l.ou,{propsConfigs:{dayOfMonthBtnProps:{defaultBtnProps:{_hover:{background:"teal",color:"white"}},selectedBtnProps:{background:"teal",color:"white"},isInRangeBtnProps:{background:"teal",color:"white"},todayBtnProps:{colorScheme:"teal"}},popoverCompProps:{popoverContentProps:{colorScheme:"teal"},popoverBodyProps:{colorScheme:"teal"}},dateNavBtnProps:{colorScheme:"teal"}},maxDate:new Date,selectedDates:S,onDateChange:E})}),(0,Z.jsx)(c.z,{ml:"3",type:"button",colorScheme:"teal",onClick:function(){E(H),$(N)},children:"Reset"}),(0,Z.jsxs)(s.x,{ml:"8",children:[(0,Z.jsxs)(s.x,{as:"span",fontWeight:"semibold",children:["deposit"===n?"Collected":"Paid out"," Amount:"," "]}),(0,Z.jsx)(s.x,{as:"span",w:"100%",fontSize:"xl",children:Number(me).toLocaleString("en-IN",{maximumFractionDigits:2,style:"currency",currency:"INR"})})]})]}),!!le.length&&(0,Z.jsx)(i.xu,{borderWidth:"thin",borderColor:"GrayText",padding:"4",borderRadius:"lg",bg:"white",width:"100%",children:(0,Z.jsx)(C.Z,{columns:ue,data:le})}),!le.length&&!M&&(0,Z.jsx)(g.Z,{title:"No Record Found",description:"The records you're looking for does not seem to exist",ctaTitle:"Go to Home",ctaPath:"/"}),B&&G&&(0,Z.jsx)(D.Z,{onStatusChanged:function(e,t){return function(){W({status:e,comment:t}),ne()}},isOpen:G,onClose:V,data:B,transactionType:n,loading:se,onSaveComment:function(e,t){"deposit"===n&&(ce(!0),(0,w.l7)(B.id,void 0,e).then((function(e){ce(!1),200===(null===e||void 0===e?void 0:e.status)?(U(e.data.responseData),de(j.Jh,e.data.responseData),x.Am.success("Comment Added!"),t&&t()):x.Am.error("Comment add failed")}))),"cashout"===n&&(ce(!0),(0,w.xl)(B.id,void 0,e).then((function(e){ce(!1),200===e.status?(x.Am.success("Comment Added!"),de(j.wK,e.data.responseData),U(e.data.responseData),t&&t()):x.Am.error("Comment add failed")})))},onDeleteComment:function(e){return function(){"deposit"===n&&(0,w.n6)(B.id,e).then((function(e){ce(!1),200===(null===e||void 0===e?void 0:e.status)?(U(e.data.responseData),de(j.Jh,e.data.responseData),x.Am.success("Comment Deleted")):x.Am.error("Comment delete failed")})),"cashout"===n&&(0,w.pw)(B.id,e).then((function(e){ce(!1),200===e.status?(x.Am.success("Comment Deleted"),de(j.wK,e.data.responseData),U(e.data.responseData)):x.Am.error("Comment delete failed")}))}}}),(0,Z.jsx)(I,{updateDetails:q,onConfirm:function(){var e=q.status;oe(),"deposit"===n&&(ce(!0),(0,w.l7)(B.id,e).then((function(e){ce(!1),200===(null===e||void 0===e?void 0:e.status)?(U(e.data.responseData),de(j.Jh,e.data.responseData),x.Am.success("Payment status updated!")):x.Am.error("Update status failed")}))),"cashout"===n&&(ce(!0),(0,w.xl)(B.id,e).then((function(e){ce(!1),200===e.status?(x.Am.success("Payment status updated!"),de(j.wK,e.data.responseData),U(e.data.responseData)):x.Am.error("Update status failed")})))},isOpen:te,onClose:oe})]})}},7522:function(e,t,n){n.d(t,{Dn:function(){return i},jP:function(){return s},qe:function(){return c}});var o=n(4165),a=n(5861),r=n(2140),s=function(){var e=(0,a.Z)((0,o.Z)().mark((function e(){var t;return(0,o.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,r.x1.get("/merchant");case 2:if(200!==(t=e.sent).status){e.next=5;break}return e.abrupt("return",t.data.responseData||[]);case 5:return e.abrupt("return",[]);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),c=function(e){return r.x1.post("/merchant",e)},i=function(e,t){return r.x1.put("/merchant/".concat(e),t)}}}]);